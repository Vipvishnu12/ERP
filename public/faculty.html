<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Department Dashboard | ClixAX - Faculty</title>
    <link rel="stylesheet" href="faculty.css">
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-title">HOD Portal</div>
        <div class="sidebar-menu">
            <li id="dashboardLink">
                <i>📊</i>
                <span>Dashboard</span>
            </li>
            <li>
                <i>👨‍🎓</i>
                <span>Students</span>
            </li>
            <li class="active">
                <i>👨‍🏫</i>
                <span>Faculty</span>
            </li>
            <li>
                <i>🏢</i>
                <span>Placements</span>
            </li>
            <li>
                <i>📋</i>
                <span>Attendance</span>
            </li>
            <li>   <i>🚪</i> 
            <span>Logout</span>  </li>
        </div>
    </div>
    
    <div class="main-content">
        <div class="page-header">
            <h1 class="page-title">Faculty</h1>
            <div style="display: flex; gap: 15px; align-items: center;" style="display: none;">
               <!-- <button class="btn-add" id="" ><span>+</span> Add Faculty</button> -->
    
            </div> 
            
        </div>
        
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-title"><span class="stat-icon">👨‍🏫</span> Total Faculty</div>
                <div class="stat-value"  id="t">--</div>
                <div class="stat-subtitle">Academic staff</div>
            </div>
            <div class="stat-card">
                <div class="stat-title"><span class="stat-icon">👨‍🔬</span> Professors</div>
                <div class="stat-value" id="p">--</div>
                <div class="stat-subtitle">Senior staff</div>
            </div>
            <div class="stat-card">
                <div class="stat-title"><span class="stat-icon">👩‍🏫</span> Associate Professors</div>
                <div class="stat-value" id="asp">--</div>
                <div class="stat-subtitle">Mid-level staff</div>
            </div>
            <div class="stat-card">
                <div class="stat-title"><span class="stat-icon">🧑‍🏫</span> Assistant Professors</div>
                <div class="stat-value" id="aasp">--</div>
                <div class="stat-subtitle">Junior staff</div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title"><i>👨‍🏫</i> Faculty Members</h2>
            <div id="faculty-container" class="faculty-grid">
                <!-- Faculty cards will be loaded here dynamically -->
            </div>
            
            <a href="#" class="view-all" id="viewAllBtn">View All Faculty</a>
        </div>
        
        
        <!-- <div class="card">
            <h2 class="card-title"><i>📊</i> Faculty Performance</h2>
            <div class="performance-item">
                <div class="performance-icon icon-green">✓</div>
                <div class="performance-content">
                    <div class="performance-date">22 Nov</div>
                    <div class="performance-text">Completed "Advanced Teaching Methods" workshop</div>
                </div>
            </div>
            <div class="performance-item">
                <div class="performance-icon icon-blue">⭐</div>
                <div class="performance-content">
                    <div class="performance-date">17 Nov</div>
                    <div class="performance-text">Received excellent student feedback for CS101 Introduction to Programming</div>
                </div>
                <div class="performance-action">Read more</div>
            </div>
            <div class="performance-item">
                <div class="performance-icon icon-purple">👥</div>
                <div class="performance-content">
                    <div class="performance-date">15 Nov</div>
                    <div class="performance-text">Joined the committee "Curriculum Development"</div>
                </div>
            </div>
            <div class="performance-item">
                <div class="performance-icon icon-orange">📝</div>
                <div class="performance-content">
                    <div class="performance-date">12 Nov</div>
                    <div class="performance-text">Published research paper "AI Integration in Education"</div>
                </div>
                <div class="performance-action">View paper</div>
            </div>
            <a href="#" class="view-all">View All Performance Records</a>
        </div>
         -->
        <div class="card">
            <h2 class="card-title"><i>📋</i> Faculty Tasks</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>Staff Name</th>
                        <th>To-Do</th>
                        <th>Assigned_Date</th>
                        <th>Status</th>
                        <th>Completion Date</th>
                    </tr>
                </thead>
                <tbody id="createrows">
                           </tbody>
            </table>
            <a href="#" class="view-all" id="viewAllCoursesBtn">View All Tasks →</a>
    
              </div>
    </div>
    
    <!-- <script src="faculty.js"></script> -->
    
    <script>
        // Add event listener to the Add Faculty button
        const urlParams = new URLSearchParams(window.location.search);
        const dept = urlParams.get('dept');
        // document.getElementById('addFacultyBtn').addEventListener('click', function() {
        //     // Navigate to the add faculty page
        //     window.location.href = `addfaculty.html?dept=${dept}`;
        // });
        
        // Add event listener for navigation to dashboard
        // document.getElementById('dashboardLink').addEventListener('click', function() {
        //     // Navigate to the dashboard page
        //     window.location.href = 'dashboard.html';
        // });
        
        
        // Add event listeners for all sidebar menu items
        document.addEventListener('DOMContentLoaded', function() {
            // Get all sidebar menu items
            const menuItems = document.querySelectorAll('.sidebar-menu li');
            
            // Add click event listeners to each menu item
            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    const pageName = this.querySelector('span').textContent.toLowerCase();
                    
                    // Remove active class from all menu items
                    menuItems.forEach(item => item.classList.remove('active'));
                    
                    // Add active class to clicked menu item
                    this.classList.add('active');
                    
                    // Navigate to the appropriate pagewsqw
                    switch(pageName) {
                        case 'dashboard':
                        window.location.href = `dashboard.html?dept=${dept}`;
                            break;
                        case 'students':
                            window.location.href = `Student.html?dept=${dept}`;
                            break;
                        case 'faculty':
                            window.location.href = `faculty.html?dept=${dept}`;
                            break;
                        case 'placements':
                            window.location.href = `Placement.html?dept=${dept}`;
                            break;
                        case 'attendance':
                            window.location.href = `attendance.html?dept=${dept}`;
                            break;
                        case 'reports':
                            window.location.href = 'reports.html';
                            break;
                        case 'settings':
                            window.location.href = 'settings.html';
                            break;
                        case 'logout':
                            // Handle logout functionality
                            alert('Logging out...');
                            window.location.href = 'login.html';
                            break;
                    }
                });
            });
        });
        window.onload = () => {
    loadCourses(); // Load courses on page load
};

async function loadCourses() {
    try {
        //Fetch faculty counts
        const resp = await fetch(`/facultycounts/${dept}`);
        const dat = await resp.json();

        // Set faculty count values to DOM
        document.getElementById("t").innerHTML = `${dat.total_faculty}`;
        document.getElementById("p").innerHTML = `${dat.professors}`;
        document.getElementById("asp").innerHTML = `${dat.associate_Professors}`;
        document.getElementById("aasp").innerHTML = `${dat.assistant_Professors}`;

        // Fetch faculty work
        const response = await fetch(`/facultywork4/${dept}`);
        const data = await response.json();
console.log(data)
        const tableBody = document.getElementById('createrows');
        if (!tableBody) {
            console.error('Table body with id "createrows" not found!');
            return;
        }

        tableBody.innerHTML = ""; // Clear existing rows

        data.forEach(course => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${course.Work_Assign_By}</td>
                <td>${course.Work_Details}</td>
                <td>${course.Completion_Status}</td>
                <td>${course.Target_Dt}</td>
                <td>${course.Work_Assign_Dt}</td>
            `;
            tableBody.appendChild(row);
        });

    } catch (error) {
        console.error('Error fetching course data:', error);
        const errorRow = `<tr><td colspan="10">Failed to load data</td></tr>`;
        const tableBody = document.getElementById('createrows');
        if (tableBody) tableBody.innerHTML = errorRow;
    }
}
async function loadFacultyCards() {
    try {
        const response = await fetch(`/facultyinfo/${dept}`); // your API endpoint
        if (!response.ok) throw new Error("Failed to fetch faculty data");

        const data = await response.json();
        const container = document.getElementById("faculty-container");
        container.innerHTML = ""; // Clear existing content

        data.forEach(faculty => {
    const card = document.createElement("div");
    card.classList.add("faculty-card");

    // Check if the faculty has a photo, if not, use the gender icon
    const photo = faculty.photo ? 
        `<img src="${faculty.photo}" alt="${faculty.Staff_Name}" class="faculty-photo" />` :
        (faculty.gender === "female" ? "👩‍🏫" : "👨‍🏫");

    card.innerHTML = `
        <div class="faculty-image">
            ${photo}
        </div>
        <div class="faculty-info">
            <div class="faculty-name">${faculty.Staff_Name}</div>
            <div class="faculty-designation">${faculty.Designation}, ${faculty.roleofwork}</div>
            <div class="faculty-meta">
                <div>${faculty.qualification}</div>
                <div>${faculty.Experience_Year} years</div>
            </div>
        </div>
    `;

    container.appendChild(card);
});


    } catch (error) {
        console.error("Error loading faculty cards:", error);
        document.getElementById("faculty-container").innerHTML = `<p>Error loading data</p>`;
    }
}

// Call function when DOM is ready
document.addEventListener("DOMContentLoaded", loadFacultyCards);
document.getElementById("viewAllCoursesBtn").addEventListener("click", function (e) {
    e.preventDefault(); // prevent default anchor behavior
    window.location.href = `allfaculty.html?dept=${dept}`;
});
document.getElementById("viewAllBtn").addEventListener("click", function (e) {
    e.preventDefault(); // prevent default anchor behavior
    window.location.href = `facultyinfo.html?dept=${dept}`;
});


    </script>
</body>
</html>